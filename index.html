<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediControl - Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const { useState } = React;
        
        // Componentes de iconos simples (ya que lucide-react no funciona bien en CDN)
        const FileText = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
                <polyline points="10 9 9 9 8 9"/>
            </svg>
        );

        const Eye = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
            </svg>
        );

        const EyeOff = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
            </svg>
        );

        const User = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                <circle cx="12" cy="7" r="4"/>
            </svg>
        );

        const Lock = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
        );

        const AlertCircle = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
        );

        const CheckCircle = () => (
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
        );

        const LoginApp = () => {
            const [rut, setRut] = useState('');
            const [password, setPassword] = useState('');
            const [userType, setUserType] = useState('independent');
            const [showPassword, setShowPassword] = useState(false);
            const [error, setError] = useState('');
            const [success, setSuccess] = useState('');
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [currentUser, setCurrentUser] = useState(null);

            const users = {
                'independent': [
                    { rut: '12.345.678-9', password: 'matias123', name: 'MatÃ­as PÃ©rez', type: 'independent' },
                    { rut: '98.765.432-1', password: 'ana123', name: 'Ana GonzÃ¡lez', type: 'independent' }
                ],
                'dependent': [
                    { rut: '23.456.789-0', password: 'juan123', name: 'Juan PÃ©rez', type: 'dependent' },
                    { rut: '34.567.890-1', password: 'maria123', name: 'MarÃ­a PÃ©rez', type: 'dependent' }
                ]
            };

            const formatRut = (value) => {
                const cleaned = value.replace(/[^\dkK]/g, '');
                if (cleaned.length <= 1) return cleaned;
                
                const body = cleaned.slice(0, -1);
                const dv = cleaned.slice(-1);
                
                const formatted = body.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
                return `${formatted}-${dv}`;
            };

            const handleRutChange = (e) => {
                const value = e.target.value;
                if (value.length <= 12) {
                    setRut(formatRut(value));
                }
            };

            const handleLogin = (e) => {
                e.preventDefault();
                setError('');
                setSuccess('');

                if (!rut || !password) {
                    setError('Por favor completa todos los campos');
                    return;
                }

                const userList = users[userType];
                const user = userList.find(u => u.rut === rut && u.password === password);

                if (user) {
                    setSuccess(`Â¡Bienvenido ${user.name}!`);
                    setCurrentUser(user);
                    setTimeout(() => {
                        setIsLoggedIn(true);
                    }, 1500);
                } else {
                    setError('RUT o contraseÃ±a incorrectos');
                }
            };

            if (isLoggedIn) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center p-6">
                        <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center">
                            <div className="mb-6">
                                <div className="inline-block bg-green-100 rounded-full p-4 mb-4">
                                    <CheckCircle />
                                </div>
                                <h2 className="text-3xl font-bold text-gray-800 mb-2">Â¡SesiÃ³n Iniciada!</h2>
                                <p className="text-gray-600 mb-4">Bienvenido, {currentUser.name}</p>
                                <div className="bg-blue-50 rounded-xl p-4 mb-6">
                                    <p className="text-sm text-blue-800"><strong>Tipo:</strong> {currentUser.type === 'independent' ? 'Usuario Independiente' : 'Usuario Dependiente'}</p>
                                    <p className="text-sm text-blue-800"><strong>RUT:</strong> {currentUser.rut}</p>
                                </div>
                            </div>
                            <button
                                onClick={() => {
                                    setIsLoggedIn(false);
                                    setCurrentUser(null);
                                    setRut('');
                                    setPassword('');
                                    setError('');
                                    setSuccess('');
                                }}
                                className="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 rounded-xl font-semibold shadow-lg hover:shadow-xl transition duration-300"
                            >
                                Cerrar SesiÃ³n
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center p-6">
                    <div className="w-full max-w-md">
                        <div className="text-center mb-8">
                            <div className="inline-block bg-white rounded-full p-4 mb-4 shadow-lg animate-bounce">
                                <FileText />
                            </div>
                            <h1 className="text-4xl font-bold text-white mb-2">MediControl</h1>
                            <p className="text-blue-100 text-lg">Tu salud en tus manos</p>
                        </div>

                        <div className="bg-white rounded-3xl shadow-2xl p-6 space-y-4">
                            <div className="text-center mb-4">
                                <h2 className="text-2xl font-bold text-gray-800">Iniciar SesiÃ³n</h2>
                                <p className="text-gray-500 text-sm">Ingresa tus credenciales</p>
                            </div>

                            {error && (
                                <div className="bg-red-50 border-2 border-red-200 rounded-xl p-4 flex items-start gap-3">
                                    <div className="flex-shrink-0 mt-0.5 text-red-600">
                                        <AlertCircle />
                                    </div>
                                    <div>
                                        <p className="text-red-800 font-semibold text-sm">Error</p>
                                        <p className="text-red-700 text-sm">{error}</p>
                                    </div>
                                </div>
                            )}

                            {success && (
                                <div className="bg-green-50 border-2 border-green-200 rounded-xl p-4 flex items-start gap-3">
                                    <div className="flex-shrink-0 mt-0.5 text-green-600">
                                        <CheckCircle />
                                    </div>
                                    <div>
                                        <p className="text-green-800 font-semibold text-sm">Â¡Ã‰xito!</p>
                                        <p className="text-green-700 text-sm">{success}</p>
                                    </div>
                                </div>
                            )}

                            <div>
                                <label className="block text-gray-700 font-medium mb-2 text-sm flex items-center gap-1">
                                    <User />
                                    RUT
                                </label>
                                <input
                                    type="text"
                                    value={rut}
                                    onChange={handleRutChange}
                                    placeholder="12.345.678-9"
                                    className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition"
                                />
                            </div>

                            <div>
                                <label className="block text-gray-700 font-medium mb-2 text-sm flex items-center gap-1">
                                    <Lock />
                                    ContraseÃ±a
                                </label>
                                <div className="relative">
                                    <input
                                        type={showPassword ? 'text' : 'password'}
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                                        className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition pr-12"
                                    />
                                    <button
                                        type="button"
                                        onClick={() => setShowPassword(!showPassword)}
                                        className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600"
                                    >
                                        {showPassword ? <EyeOff /> : <Eye />}
                                    </button>
                                </div>
                            </div>

                            <div>
                                <label className="block text-gray-700 font-medium mb-2 text-sm">
                                    Tipo de Usuario
                                </label>
                                <select
                                    value={userType}
                                    onChange={(e) => setUserType(e.target.value)}
                                    className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition"
                                >
                                    <option value="independent">Usuario Independiente</option>
                                    <option value="dependent">Usuario Dependiente</option>
                                </select>
                            </div>

                            <button
                                onClick={handleLogin}
                                className="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 rounded-xl font-semibold shadow-lg hover:shadow-xl transition duration-300 transform hover:scale-105"
                            >
                                Iniciar SesiÃ³n
                            </button>

                            <div className="text-center space-y-2 pt-2">
                                <button className="text-blue-600 text-sm font-medium hover:underline">
                                    Â¿Olvidaste tu contraseÃ±a?
                                </button>
                                <div>
                                    <span className="text-gray-600 text-sm">Â¿No tienes cuenta? </span>
                                    <button className="text-blue-600 text-sm font-semibold hover:underline">
                                        RegÃ­strate aquÃ­
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="mt-6 bg-white/10 backdrop-blur-sm rounded-2xl p-4 text-white text-sm">
                            <h3 className="font-bold mb-2 text-center">ðŸ‘¥ Usuarios de Prueba</h3>
                            <div className="space-y-2">
                                <div className="bg-white/20 rounded-lg p-2">
                                    <p className="font-semibold">Usuarios Independientes:</p>
                                    <p className="text-xs">â€¢ 12.345.678-9 / matias123</p>
                                    <p className="text-xs">â€¢ 98.765.432-1 / ana123</p>
                                </div>
                                <div className="bg-white/20 rounded-lg p-2">
                                    <p className="font-semibold">Usuarios Dependientes:</p>
                                    <p className="text-xs">â€¢ 23.456.789-0 / juan123</p>
                                    <p className="text-xs">â€¢ 34.567.890-1 / maria123</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<LoginApp />);
    </script>
</body>
</html>
